# Railway Deployment Guide for MyAiMediaMgr

## Prerequisites
- Railway account (https://railway.app)
- GitHub repository with the code
- Stripe account with API keys
- Google Cloud account (optional for AI features)

## Deployment Steps

### 1. Connect to Railway
1. Log in to Railway dashboard
2. Click "New Project"
3. Select "Deploy from GitHub repo"
4. Connect your GitHub repository

### 2. Configure Environment Variables
In Railway dashboard, add these required environment variables:

#### Required Variables:
```env
# Database (Railway will auto-generate these when you add PostgreSQL)
DATABASE_URL=<auto-generated>
PGDATABASE=<auto-generated>
PGHOST=<auto-generated>
PGPASSWORD=<auto-generated>
PGPORT=<auto-generated>
PGUSER=<auto-generated>

# Authentication
SESSION_SECRET=<generate-a-32-char-random-string>
REPLIT_DOMAINS=yourdomain.railway.app
ISSUER_URL=https://replit.com/oidc
REPL_ID=your-app-id

# Stripe Payments
STRIPE_SECRET_KEY=sk_live_your_stripe_secret_key
VITE_STRIPE_PUBLIC_KEY=pk_live_your_stripe_public_key
```

#### Optional Variables (for AI features):
```env
GCLOUD_PROJECT_ID=your-project-id
GEMINI_API_KEY=your-gemini-api-key
```

### 3. Add PostgreSQL Database
1. In Railway project, click "New"
2. Select "Database" > "Add PostgreSQL"
3. Railway will automatically connect it to your app

### 4. Initialize Database
After deployment, run the database migration:
1. Go to Railway dashboard
2. Open the service shell
3. Run: `npm run db:push`

### 5. Configure Domain (Optional)
1. Go to Settings in Railway
2. Add a custom domain or use the generated Railway domain
3. Update REPLIT_DOMAINS environment variable with your domain

## Admin Access
The application includes a built-in admin system:
- **Admin Login URL**: `https://yourdomain.railway.app/admin/login`
- **Admin Email**: `spencerandtheteagues@gmail.com`
- **Admin Password**: `TheMoonKey8!`

Admin capabilities:
- Bypass all paywalls
- Infinite credits
- User management
- Credit adjustments
- View system statistics

## Build Configuration
The app uses these commands (already configured in railway.json):
- **Build**: `npm install && npm run build`
- **Start**: `npm run start`

## Health Checks
Railway will automatically monitor:
- Application health at `/`
- Database connectivity
- Service uptime

## Troubleshooting

### Database Connection Issues
- Ensure DATABASE_URL is properly set
- Check PostgreSQL service is running
- Verify database migrations ran successfully

### Build Failures
- Check Node.js version compatibility (v18+)
- Verify all dependencies are in package.json
- Check build logs in Railway dashboard

### Authentication Issues
- Verify SESSION_SECRET is set
- Check REPLIT_DOMAINS matches your domain
- Ensure cookies are enabled for sessions

### Payment Issues
- Verify Stripe keys are correct
- Check Stripe webhook configuration
- Ensure production keys are used (not test keys)

## Production Optimizations
The app is optimized for Railway with:
- Efficient build caching
- Database connection pooling
- Automatic restart on failure
- Health check monitoring
- Production environment variables

## Monitoring
Railway provides:
- Real-time logs
- Metrics dashboard
- Deployment history
- Resource usage tracking

## Support
For deployment issues:
1. Check Railway logs for errors
2. Verify all environment variables are set
3. Ensure database is properly initialized
4. Contact Railway support if needed